function RV = El2RV(elem)



%elem=[a;e;i;W;w;M];
%el=[a;i;W;w;e;M];
el=[elem(1);elem(3);elem(4);elem(5);elem(2);elem(6)];

%-------------------------------------------------------------------------------
%   轨道要素转位置矢量和速度矢量.
%-------------------------------------------------------------------------------
%   格式:
%   [r, v] = El2RV( el, tol, mu )
%-------------------------------------------------------------------------------
%
%   ------
%   输入
%   ------
%   el              (6,:) 六要素 [a;i;W;w;e;M] (弧度)
%   tol             (1,1) Tolerance for Kepler's equation solver
%   mu              (1,1) Gravitational constant
%
%   -------
%   输出
%   -------
%   r               (3,:) 位置矢量
%   v               (3,:) 速度矢量
%
%-------------------------------------------------------------------------------

%-------------------------------------------------------------------------------

mu = 3.9860044e14;
tol = 1.e-14;

%  Elements vector [a;i;W;w;e;M]
%-------------------------------
  e      = el(5);
  M      = el(6);
  a      = el(1);
  f      = M2Nu( e, M, tol, 200 );

  if( e ~= 1 )
    p    = a*(1-e)*(1+e);
  else
    p    = a*(1+e);
  end
  
  cf     = cos(f);
  sf     = sin(f);
   
  rp     = p/(1 + e*cf)*[ cf; sf; 0 ];
  vp     = sqrt(mu/p)*[-sf; e+cf; 0];
 
  c      = CP2I( el(2), el(3), el(4) );


  r = c*rp;
  v = c*vp;

RV=[r;v];

